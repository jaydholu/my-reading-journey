<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>

    <!-- Modern Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

    <!-- Bootstrap (for modals and utilities) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/my-reading-journey-icon.png') }}">

    <!-- Base Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">

    {% block css %}{% endblock css %}
</head>

<body>
    <div class="page-container">
        <!-- Modern Navbar -->
        <nav class="navbar">
            <div class="nav-container">
                <!-- Logo Section -->
                <div class="nav-brand">
                    <a href="{{ url_for('main.home') }}" class="logo-link">
                    <div class="logo-container">
                            <div class="logo-icon">
                                <img src="{{ url_for('static', filename='img/my-reading-journey-icon.png') }}"
                                    alt="My Reading Journey"
                                    style="width: auto; height: auto; max-width: 40px; max-height: 35px;">
                            </div>
                            <div class="brand-text">
                                <span class="brand-name">My Reading</span>
                                <span class="brand-subtitle">Journey</span>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Desktop Navigation -->
                <div class="nav-menu desktop-nav">
                    <a href="{{ url_for('main.home') }}" class="nav-link">
                        <i class="bx bx-home"></i>
                        <span>Home</span>
                    </a>
                    {% if session.get('user_id') %}
                    <a href="{{ url_for('books.add_book') }}" class="nav-link">
                        <i class="bx bx-plus"></i>
                        <span>Add Book</span>
                    </a>
                    <div class="nav-dropdown">
                        <a href="#" class="nav-link dropdown-trigger">
                            <i class="bx bx-data"></i>
                            <span>Data</span>
                            <i class="bx bx-chevron-down"></i>
                        </a>
                        <div class="dropdown-menu">
                            <a href="#" class="dropdown-item" onclick="openUploadModal()">
                                <i class="bx bx-upload"></i>
                                Upload Books Data
                            </a>
                            <a href="{{ url_for('books.download_books') }}" class="dropdown-item">
                                <i class="bx bx-download"></i>
                                Download Books Data
                            </a>
                        </div>
                    </div>
                    {% else %}
                    <a href="{{ url_for('auth.sign_up') }}" class="nav-link">
                        <i class="bx bx-user-plus"></i>
                        <span>Sign Up</span>
                    </a>
                    <a href="{{ url_for('auth.login') }}" class="nav-link">
                        <i class="bx bx-log-in"></i>
                        <span>Login</span>
                    </a>
                    {% endif %}
                    <div class="nav-dropdown">
                        <a href="#" class="nav-link dropdown-trigger">
                            <i class="bx bx-info-circle"></i>
                            <span>About</span>
                            <i class="bx bx-chevron-down"></i>
                        </a>
                        <div class="dropdown-menu">
                            <a href="{{ url_for('main.about') }}" class="dropdown-item">
                                <i class="bx bx-info-circle"></i>
                                About Web App
                            </a>
                            <a href="{{ url_for('main.developer') }}" class="dropdown-item">
                                <i class="bx bx-code-alt"></i>
                                About Developer
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Theme Toggle & Mobile Menu -->
                <div class="nav-controls">
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fa fa-moon"></i>
                    </button>

                    {% if session.get('user_id') and current_user %}
                    <div class="user-menu">
                        <div class="user-info">
                            <button class="user-avatar">
                                <i class="bx bx-user"></i>
                                <!-- <span class="user-name">{{ current_user.name }}</span> -->
                            </button>
                        </div>
                        <div class="user-dropdown">
                            <div class="user-dropdown-info">
                                <div class="user-dropdown-name">{{ current_user.name }}</div>
                                <!-- <div class="user-dropdown-email">{{ current_user.email }}</div> -->
                            </div>
                            <div class="user-dropdown-divider"></div>
                            <a href="{{ url_for('user.settings') }}" class="dropdown-item">
                                <i class="bx bx-cog"></i>
                                Settings
                            </a>
                            <a href="{{ url_for('auth.logout') }}" class="dropdown-item">
                                <i class="bx bx-log-out"></i>
                                Logout
                            </a>
                        </div>
                    </div>
                    {% endif %}

                    <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>

            <!-- Mobile Navigation -->
            <div class="mobile-nav" id="mobile-nav">
                <a href="{{ url_for('main.home') }}" class="mobile-nav-link">
                    <i class="bx bx-home"></i>
                    <span>Home</span>
                </a>
                {% if session.get('user_id') %}
                <a href="{{ url_for('books.add_book') }}" class="mobile-nav-link">
                    <i class="bx bx-plus"></i>
                    <span>Add Book</span>
                </a>
                <a href="#" class="mobile-nav-link" onclick="openUploadModal()">
                    <i class="bx bx-upload"></i>
                    <span>Upload Books Data</span>
                </a>
                <a href="{{ url_for('books.download_books') }}" class="mobile-nav-link">
                    <i class="bx bx-download"></i>
                    <span>Download Books Data</span>
                </a>
                {% if current_user %}
                <div class="mobile-user-info">
                    <div class="mobile-user-name">{{ current_user.name }}</div>
                    <div class="mobile-user-email">{{ current_user.email }}</div>
                </div>
                {% endif %}
                <a href="{{ url_for('auth.logout') }}" class="mobile-nav-link">
                    <i class="bx bx-log-out"></i>
                    <span>Logout</span>
                </a>
                {% else %}
                </a>
                <a href="{{ url_for('auth.sign_up') }}" class="mobile-nav-link">
                    <i class="bx bx-user-plus"></i>
                    <span>Sign Up</span>
                </a>
                <a href="{{ url_for('auth.login') }}" class="mobile-nav-link">
                    <i class="bx bx-log-in"></i>
                    <span>Login</span>
                </a>
                {% endif %}
                <a href="{{ url_for('main.about') }}" class="mobile-nav-link">
                    <i class="bx bx-info-circle"></i>
                    <span>About Web App</span>
                </a>
                <a href="{{ url_for('main.developer') }}" class="dropdown-item">
                    <i class="bx bx-code-alt"></i>
                    <span>About Developer</span>
                </a>
            </div>
        </nav>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
        <div class="flash-container">
            {% for category, message in messages %}
            <div class="flash-message flash-{{ category }}">
                <div class="flash-icon">
                    {% if category == 'success' %}
                    <i class="bx bx-check-circle"></i>
                    {% elif category == 'danger' %}
                    <i class="bx bx-error-circle"></i>
                    {% elif category == 'warning' %}
                    <i class="bx bx-error"></i>
                    {% else %}
                    <i class="bx bx-info-circle"></i>
                    {% endif %}
                </div>
                <span class="flash-text">{{ message }}</span>
                <button class="flash-close" onclick="this.parentElement.remove()">
                    <i class="bx bx-x"></i>
                </button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <!-- Main Content -->
        <main class="main-content">
            {% block content %}{% endblock %}
        </main>

        <!-- Modern Footer -->
        <footer class="footer" id="contact">
            <div class="footer-container">
                <div class="footer-content">
                    <div class="footer-section">
                        <div class="footer-brand">
                            <div class="footer-logo">
                                <img src="{{ url_for('static', filename='img/my-reading-journey-icon.png') }}"
                                    alt="My Reading Journey"
                                    style="width: auto; height: auto; max-width: 50px; max-height: 45px;">
                            </div>
                            <div class="footer-text">
                                <h3>My Reading Journey</h3>
                                <p>Track, rate, and organize your reading adventures</p>
                            </div>
                        </div>
                    </div>

                    <div class="footer-section">
                        <h4>Connect with us</h4>
                        <div class="social-links">
                            <a href="https://github.com/organizations/code-cosmos-tech" target="_blank"
                                class="social-link">
                                <i class="fa-brands fa-github"></i>
                            </a>
                            <a href="https://linkedin.com/in/codecosmostech" target="_blank" class="social-link">
                                <i class="fa-brands fa-linkedin"></i>
                            </a>
                            <a href="https://x.com/codecosmostech" target="_blank" class="social-link">
                                <i class="fa-brands fa-x-twitter"></i>
                            </a>
                            <a href="https://www.instagram.com/codecosmostech/" target="_blank" class="social-link">
                                <i class="fa-brands fa-instagram"></i>
                            </a>
                            <a href="mailto:codecosmostech@gmail.com" class="social-link">
                                <i class="fa fa-envelope"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="footer-bottom">
                    <p>&copy; 2025 Code And Cosmos. Crafted with passion for readers.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Upload Modal -->
    <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modern-modal">
                <div class="modal-header">
                    <div class="modal-title-container">
                        <i class="bx bx-upload"></i>
                        <h5 class="modal-title" id="uploadModalLabel">Upload Your JSON Books Data</h5>
                    </div>
                    <button type="button" class="modal-close" data-bs-dismiss="modal">
                        <i class="bx bx-x"></i>
                    </button>
                </div>
                <form id="uploadForm" method="POST" action="{{ url_for('books.upload_books') }}"
                    enctype="multipart/form-data">
                    {{ json_form.hidden_tag() }}
                    <div class="modal-body">
                        <div class="upload-area">
                            <div class="upload-icon">
                                <i class="bx bx-cloud-upload"></i>
                            </div>
                            <p class="upload-text">Choose your JSON file</p>
                            {{ json_form.json_file(class="file-input") }}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="uploadSubmitBtn">Upload Books</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    {% block script %}{% endblock %}
</body>

</html>